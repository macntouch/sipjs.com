<!-- We use this file only for the home page -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Language" content="en-us" />
  <meta http-equiv="imagetoolbar" content="false" />
  <meta name="MSSmartTagsPreventParsing" content="true" />
  <meta name="description" content="Add SIP signaling to your WebRTC app with this simple, open source JavaScript library - SIP.js." />
  <meta name="viewport" content="initial-scale=1" />
  <title>SIP Signaling JavaScript Library for WebRTC Developers | SIP.js</title>
  <link rel="alternate" type="application/atom+xml" title="API Changes" href="/changes.atom" />
  <link href='http://fonts.googleapis.com/css?family=Nunito:400,700,300|Varela+Round' rel='stylesheet' type='text/css'>
  <link href="/css/reset.css" rel="stylesheet" type="text/css" />
  <link href="/css/960.css" rel="stylesheet" type="text/css" />
  <link href="/css/uv_active4d.css" rel="stylesheet" type="text/css" />
  <link href="/shared/css/documentation.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="/shared/css/adaptive.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/shared/css/pygments.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/shared/css/success-popup.css" media="screen" rel="stylesheet" type="text/css" />
  <script src="/shared/js/jquery.js" type="text/javascript"></script>
  <script src="/shared/js/documentation.js" type="text/javascript"></script>
  <link rel="shortcut icon" type="image/x-icon" href="/shared/img/favicon-6.ico"/>
</head>


<body class="overview">
	<div id="dev"></div>
<header id="siteHeader">
  <div class="wrapper">
    <nav id="mainNav"><a id="logo-link" href="/"><img id="logo" src="/shared/img/logo.png" alt="sip.js"></a>
      <ul id="mobile-nav" class="horizontal desktop-hide">
        <li id="mobile-menu" class="dead-center-container">
          <span class="dead-center-content">Menu</span>
        </li>
        <li id="mobile-api" class="dead-center-container">
          <a class="dead-center-content" href="/api/0.6.0/">API</a>
        </li>
      </ul>
      <ul id="full-nav" class="horizontal mobile-hide">
        <li><a href="/download/">Download</a></li>
        <li><a id="api-nav" href="/api/0.6.0/">API</a></li>
        <li><a href="/guides/">Guides</a></li>
        <li><a href="https://github.com/onsip/sip.js" target="_blank">Github</a></li>
        <li><a href="/aboutus/" class="nav-aboutus">About Us</a></li>
        <li><a href="https://groups.google.com/forum/#!forum/sip_js" target="_blank">Support</a></li>
      </ul>
    </nav>
    <nav id="drawer-nav" class="desktop-hide">
      <ul id="drawer-list" class="horizontal">
        <li><a href="/download/">Download</a></li>
        <li><a id="api-nav" href="/api/0.6.0/">API</a></li>
        <li><a href="/guides/">Guides</a></li>
        <li><a href="https://github.com/onsip/sip.js" target="_blank">Github</a></li>
        <li><a href="/aboutus/" class="nav-aboutus">About Us</a></li>
        <li><a href="https://groups.google.com/forum/#!forum/sip_js" target="_blank">Support</a></li>
      </ul>
    </nav>
  </div>
</header>


    <div id="body">
	  <div class="wrapper-bg-extend">
  <article class="group home-feature"><div class="feature">
	  <h1>WebRTC Made Easy for JavaScript Developers</h1>
	  <h4 class="intro">A simple yet powerful JS library that takes care of WebRTC and SIP signaling for you</h4>
	</div>
  </article><div class="full-width-divider group home-feature" id="feature-selector">
    <div>
      <ul class="highlights">
<li id="feature-video-audio">
          <img class="icon-unselected" src="/shared/img/video-audio.png" alt="video + audio"><img class="icon-selected" src="/shared/img/video-audio-highlight.png" alt="video + audio highlight"><h4>video + audio</h4>
        </li>
        <li id="feature-message">
          <img class="icon-unselected" src="/shared/img/message.png" alt="message"><img class="icon-selected" src="/shared/img/message-highlight.png" alt="message highlight"><h4>message</h4>
        </li>
        <li id="feature-data-channel">
          <img class="icon-unselected" src="/shared/img/data-channel.png" alt="message"><img class="icon-selected" src="/shared/img/data-channel-highlight.png" alt="message highlight"><h4>data channel</h4>
        </li>
      </ul>
<!-- This draws an arrow that we use to indicate the highlighted feature --><svg class="arrow mobile-hide" id="feature-arrow" width="60" height="34" viewbox="0 0 80 45"><polygon points="40,5 75,40 5,40"></polygon></svg>
</div>
  </div>

  <div class="full-width-divider mid-gray-bg feature" id="feature-demo">
    <div id="demo-error">
      <h1>Oops!</h1>
      <h2>Looks like your browser can't run this demo.</h2>
      <p>
        To get the full experience, download the latest version of
        <em>Chrome</em> or <em>Firefox</em>
      </p>
    </div>
    <div id="content-video-audio">
      <h2>In-browser Video Chat is Now a Breeze</h2>
      <h4 class="intro">Here's a demo. Start a video chat between Alice and Bob.</h4>
      <div class="two-column-boxes">
        <div class="column-box">
          <div class="demo-window">
            <div class="demo-view">
              <video id="video-of-bob" muted="muted"></video>
</div>
            <div class="left">
              <h4>Alice's View</h4>
              <h5>Demo user one</h5>
            </div>
            <button id="alice-video-button" class="right" type="button">video</button>
            <div class="clearfix"></div>
          </div>
          <svg class="arrow mobile-hide demo-arrow" width="60" height="34" viewbox="0 0 80 45"><polygon points="40,5 75,40 5,40"></polygon></svg>
</div>
        <div class="column-box">
          <div class="demo-window">
            <div class="demo-view">
              <video id="video-of-alice" muted="muted"></video>
</div>
            <div class="left">
              <h4>Bob's View</h4>
              <h5>Demo user two</h5>
            </div>
            <button id="bob-video-button" class="right" type="button">video</button>
            <div class="clearfix"></div>
          </div>
        </div>
        <div class="clearfix"></div>
      </div>
    </div>
    <div id="content-message">
      <h2>Real-Time Messaging with a Dozen Lines of Code</h2>
      <h4 class="intro">Check it out. Instant message between Alice and Bob.</h4>
      <div class="two-column-boxes">
        <div class="column-box">
          <div class="demo-window">
            <div class="demo-view">
              <div id="alice-message-display" class="message-display">
                <p class="message"><span class="message-from">Bob:</span> <span class="message-body placeholder">No messages yet</span></p>
              </div>
              <textarea id="alice-message-input" class="message-input" placeholder="Enter your message to Bob here!"></textarea>
</div>
            <div class="left">
              <h4>Alice's View</h4>
              <h5>Demo user one</h5>
            </div>
            <button id="alice-message-button" class="right" type="button">send message</button>
            <div class="clearfix"></div>
          </div>
          <svg class="arrow mobile-hide demo-arrow" width="60" height="34" viewbox="0 0 80 45"><polygon points="40,5 75,40 5,40"></polygon></svg>
</div>
        <div class="column-box">
          <div class="demo-window">
            <div class="demo-view">
              <div id="bob-message-display" class="message-display">
                <p class="message"><span class="message-from">Alice:</span> <span class="message-body placeholder">No messages yet</span></p>
              </div>
              <textarea id="bob-message-input" class="message-input" placeholder="Enter your message to Alice here!"></textarea>
</div>
            <div class="left">
              <h4>Bob's View</h4>
              <h5>Demo user two</h5>
            </div>
            <button id="bob-message-button" class="right" type="button">send message</button>
            <div class="clearfix"></div>
          </div>
        </div>
        <div class="clearfix"></div>
      </div>
    </div>
    <div id="content-data-channel">
      <h2>Send Real-Time Data In A Flash</h2>
      <h4 class="intro">Go ahead. Upload a file as Alice and Download it as Bob.</h4>
      <div class="two-column-boxes">
        <div class="column-box">
          <div class="demo-window">
            <div class="demo-view">
              <div id="alice-data-display" class="message-display">
                <p class="message"><span class="message-body placeholder">No files yet sent or received</span></p>
              </div>
            </div>
            <span class="file-chooser-hack">
              <button id="alice-file-choose-button" class="file-choose-button" type="button">choose a file to send</button>
              <input id="alice-file-choose-input" type="file" name="file" class="file-choose-button"></span>
            <span id="alice-filename" class="message-body">no file selected</span>
            <div id="alice-file-error-msg" class="file-error-msg"></div>
            <div class="left">
              <h4>Alice's View</h4>
              <h5>Demo user one</h5>
            </div>
            <button id="alice-data-share-button" class="right" type="button">share</button>
            <div class="clearfix"></div>
            <svg class="arrow mobile-hide demo-arrow" width="60" height="34" viewbox="0 0 80 45"><polygon points="40,5 75,40 5,40"></polygon></svg>
</div>
        </div>
        <div class="column-box">
          <div class="demo-window">
            <div class="demo-view">
              <div id="bob-data-display" class="message-display">
                <p class="message"><span class="message-body placeholder">No files yet sent or received</span></p>
              </div>
            </div>
            <span class="file-chooser-hack">
              <button id="bob-file-choose-button" class="file-choose-button" type="button">choose a file to send</button>
              <input id="bob-file-choose-input" type="file" name="file" class="file-choose-button"></span>
            <span id="bob-filename" class="message-body">no file selected</span>
            <div id="bob-file-error-msg" class="file-error-msg"></div>
            <div class="clearfix"></div>
            <div class="left">
              <h4>Bob's View</h4>
              <h5>Demo user two</h5>
            </div>
            <button id="bob-data-share-button" class="right" type="button">share</button>
            <div class="clearfix"></div>
          </div>
        </div>
        <div class="clearfix"></div>
      </div>
    </div>
  </div>

  <div class="full-width-divider orange-bg">
    <div id="code-intro" class="left">
      <h3>See How It's Done</h3>
      <p class="left mobile-hide">
      The code displayed on the right is what powers the selected demo from Alice’s end, although Bob’s code would be very similar. SIP.js allows you to utilize WebRTC’s APIs using just JavaScript. To check out the full code for all three demos, click the button below.
      </p>
      <p class="desktop-hide">
        SIP.js makes it easy to utilize WebRTC's APIs and set up SIP communication sessions. In no time at all, you can have two separate users talking to one another. To learn more about the SIP.js API, click the button below.
      </p>
    </div>
<div class="code-wrapper mobile-hide">
<div class="index-demo-code" id="code-video-audio">
        <div>
<div class="CodeRay">
  <div class="code"><pre><span style="color:#080;font-weight:bold">var</span> domain = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">sipjs.onsip.com</span><span style="color:#710">'</span></span>;
<span style="color:#080;font-weight:bold">var</span> aliceURI      = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">alice</span><span style="color:#710">'</span></span> + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">@</span><span style="color:#710">'</span></span> + domain;
<span style="color:#080;font-weight:bold">var</span> aliceName     = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Alice</span><span style="color:#710">'</span></span>;
<span style="color:#080;font-weight:bold">var</span> aliceButton   = document.getElementById(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">alice-video-button</span><span style="color:#710">'</span></span>);

<span style="color:#080;font-weight:bold">var</span> bobURI        = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">bob</span><span style="color:#710">'</span></span> + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">@</span><span style="color:#710">'</span></span> + domain;
<span style="color:#080;font-weight:bold">var</span> bobName       = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Bob</span><span style="color:#710">'</span></span>;
<span style="color:#080;font-weight:bold">var</span> bobButton     = document.getElementById(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">bob-video-button</span><span style="color:#710">'</span></span>);

<span style="color:#777">// A shortcut function to construct the media options for an SIP session.</span>
<span style="color:#080;font-weight:bold">function</span> <span style="color:#06B;font-weight:bold">mediaOptions</span>(audio, video, remoteRender, localRender) {
    <span style="color:#080;font-weight:bold">return</span> {
        <span style="color:#606">media</span>: {
            <span style="color:#606">constraints</span>: {
                <span style="color:#606">audio</span>: audio,
                <span style="color:#606">video</span>: video
            },
            <span style="color:#606">render</span>: {
                <span style="color:#606">remote</span>: {
                    <span style="color:#606">video</span>: remoteRender
                },
                <span style="color:#606">local</span>: {
                    <span style="color:#606">video</span>: localRender
                }
            }
        }
    };
}

<span style="color:#777">// Creates a user agent with the given arguments plugged into the UA</span>
<span style="color:#777">// configuration. This is a standard user agent for WebRTC calls.</span>
<span style="color:#777">// For a user agent for data transfer, see createDataUA</span>
<span style="color:#080;font-weight:bold">function</span> <span style="color:#06B;font-weight:bold">createUA</span>(callerURI, displayName) {
    <span style="color:#080;font-weight:bold">var</span> configuration = {
        <span style="color:#606">traceSip</span>: <span style="color:#069">true</span>,
        <span style="color:#606">uri</span>: callerURI,
        <span style="color:#606">displayName</span>: displayName
    };
    <span style="color:#080;font-weight:bold">var</span> userAgent = <span style="color:#080;font-weight:bold">new</span> SIP.UA(configuration);
    <span style="color:#080;font-weight:bold">return</span> userAgent;
}

<span style="color:#777">// Makes a call from a user agent to a target URI</span>
<span style="color:#080;font-weight:bold">function</span> <span style="color:#06B;font-weight:bold">makeCall</span>(userAgent, target, audio, video, remoteRender, localRender) {
    <span style="color:#080;font-weight:bold">var</span> options = mediaOptions(audio, video, remoteRender, localRender);
    <span style="color:#777">// makes the call</span>
    <span style="color:#080;font-weight:bold">var</span> session = userAgent.invite(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">sip:</span><span style="color:#710">'</span></span> + target, options);
    <span style="color:#080;font-weight:bold">return</span> session;
}

<span style="color:#777">// Sets up the button for a user to manage calling and hanging up</span>
<span style="color:#080;font-weight:bold">function</span> <span style="color:#06B;font-weight:bold">setUpVideoInterface</span>(userAgent, target, remoteRenderId, buttonId) {
    <span style="color:#777">// true if the button should initiate a call,</span>
    <span style="color:#777">// false if the button should end a call</span>
    <span style="color:#080;font-weight:bold">var</span> onCall = <span style="color:#069">false</span>;
    <span style="color:#080;font-weight:bold">var</span> session;
    <span style="color:#080;font-weight:bold">var</span> remoteRender = document.getElementById(remoteRenderId);
    <span style="color:#080;font-weight:bold">var</span> button = document.getElementById(buttonId);

    <span style="color:#777">// Handling invitations to calls.</span>
    <span style="color:#777">// We automatically accept invitations and toggle the button state based on</span>
    <span style="color:#777">// whether we are in a call our not.</span>
    <span style="color:#777">// Also, for each new call session, we need to add an event handler to set</span>
    <span style="color:#777">// the correct button state when we receive a "bye" request.</span>
    userAgent.on(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">invite</span><span style="color:#710">'</span></span>, <span style="color:#080;font-weight:bold">function</span> (incomingSession) {
        onCall = <span style="color:#069">true</span>;
        session = incomingSession;
        <span style="color:#080;font-weight:bold">var</span> options = mediaOptions(<span style="color:#069">false</span>, <span style="color:#069">true</span>, remoteRender, <span style="color:#069">null</span>);
        button.firstChild.nodeValue = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">hang up</span><span style="color:#710">'</span></span>;
        remoteRender.style.visibility = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">visible</span><span style="color:#710">'</span></span>;
        session.accept(options);
        session.on(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">bye</span><span style="color:#710">'</span></span>, <span style="color:#080;font-weight:bold">function</span> () {
            onCall = <span style="color:#069">false</span>;
            button.firstChild.nodeValue = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">video</span><span style="color:#710">'</span></span>;
            remoteRender.style.visibility = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">hidden</span><span style="color:#710">'</span></span>;
            session = <span style="color:#069">null</span>;
        });
    });
    <span style="color:#777">// The button either makes a call, creating a session and binding a listener</span>
    <span style="color:#777">// for the "bye" request, or it hangs up a current call.</span>
    button.addEventListener(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">click</span><span style="color:#710">'</span></span>, <span style="color:#080;font-weight:bold">function</span> () {
        <span style="color:#777">// Was on a call, so the button press means we are hanging up</span>
        <span style="color:#080;font-weight:bold">if</span> (onCall) {
            onCall = <span style="color:#069">false</span>;
            button.firstChild.nodeValue = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">video</span><span style="color:#710">'</span></span>;
            remoteRender.style.visibility = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">hidden</span><span style="color:#710">'</span></span>;
            session.bye();
            session = <span style="color:#069">null</span>;
        }
        <span style="color:#777">// Was not on a call, so the button press means we are ringing someone</span>
        <span style="color:#080;font-weight:bold">else</span> {
            onCall = <span style="color:#069">true</span>;
            button.firstChild.nodeValue = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">hang up</span><span style="color:#710">'</span></span>;
            remoteRender.style.visibility = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">visible</span><span style="color:#710">'</span></span>;
            session = makeCall(userAgent, target,
                               <span style="color:#069">false</span>, <span style="color:#069">true</span>,
                               remoteRender, <span style="color:#069">null</span>);
            session.on(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">bye</span><span style="color:#710">'</span></span>, <span style="color:#080;font-weight:bold">function</span> () {
                onCall = <span style="color:#069">false</span>;
                button.firstChild.nodeValue = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">video</span><span style="color:#710">'</span></span>;
                remoteRender.style.visibility = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">hidden</span><span style="color:#710">'</span></span>;
                session = <span style="color:#069">null</span>;
            });
        }
    });
}

<span style="color:#080;font-weight:bold">var</span> aliceUA = createUA(aliceURI, aliceName);
setUpVideoInterface(aliceUA, bobURI, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">video-of-bob</span><span style="color:#710">'</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">alice-video-button</span><span style="color:#710">'</span></span>);
</pre></div>
</div>
        </div>
      </div>
</div>
<div class="code-wrapper mobile-hide">
<div class="index-demo-code" id="code-message">
        <div>
<div class="CodeRay">
  <div class="code"><pre><span style="color:#080;font-weight:bold">var</span> domain = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">sipjs.onsip.com</span><span style="color:#710">'</span></span>;
<span style="color:#080;font-weight:bold">var</span> aliceURI      = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">alice</span><span style="color:#710">'</span></span> + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">@</span><span style="color:#710">'</span></span> + domain;
<span style="color:#080;font-weight:bold">var</span> aliceName     = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Alice</span><span style="color:#710">'</span></span>;
<span style="color:#080;font-weight:bold">var</span> aliceButton   = document.getElementById(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">alice-video-button</span><span style="color:#710">'</span></span>);

<span style="color:#080;font-weight:bold">var</span> bobURI        = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">bob</span><span style="color:#710">'</span></span> + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">@</span><span style="color:#710">'</span></span> + domain;
<span style="color:#080;font-weight:bold">var</span> bobName       = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Bob</span><span style="color:#710">'</span></span>;
<span style="color:#080;font-weight:bold">var</span> bobButton     = document.getElementById(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">bob-video-button</span><span style="color:#710">'</span></span>);

<span style="color:#777">// Sets up the chat interface for text messaging</span>
<span style="color:#080;font-weight:bold">function</span> <span style="color:#06B;font-weight:bold">setUpMessageInterface</span>(userAgent, target,
                               messageRenderId, messageInputId, buttonId) {
    <span style="color:#080;font-weight:bold">var</span> messageRender = document.getElementById(messageRenderId);
    <span style="color:#080;font-weight:bold">var</span> messageInput = document.getElementById(messageInputId);
    <span style="color:#080;font-weight:bold">var</span> button = document.getElementById(buttonId);

    <span style="color:#080;font-weight:bold">function</span> <span style="color:#06B;font-weight:bold">sendMessage</span>() {
        <span style="color:#080;font-weight:bold">var</span> msg = messageInput.value;
        <span style="color:#777">// Only send a message if the message is non-empty</span>
        <span style="color:#080;font-weight:bold">if</span> (msg !== <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#710">'</span></span>) {
            messageInput.value = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#710">'</span></span>;
            userAgent.message(target, msg);
        }
    }

    <span style="color:#777">// We have placeholder text in the message render box. It should be deleted</span>
    <span style="color:#777">// after we have sent or received our first message. This keeps track of</span>
    <span style="color:#777">// that.</span>
    <span style="color:#080;font-weight:bold">var</span> noMessages = <span style="color:#069">true</span>;

    <span style="color:#777">// Receive a message and put it in the message display div</span>
    userAgent.on(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">message</span><span style="color:#710">'</span></span>, <span style="color:#080;font-weight:bold">function</span> (msg) {
        <span style="color:#777">// If we have not received any messages yet, remove the placeholder</span>
        <span style="color:#777">// text.</span>
        <span style="color:#080;font-weight:bold">if</span> (noMessages) {
            noMessages = <span style="color:#069">false</span>;
            <span style="color:#080;font-weight:bold">if</span> (messageRender.childElementCount &gt; <span style="color:#00D">0</span>)
                messageRender.removeChild(messageRender.children[<span style="color:#00D">0</span>]);
        }
        <span style="color:#080;font-weight:bold">var</span> msgTag = createMsgTag(msg.remoteIdentity.displayName, msg.body);
        messageRender.appendChild(msgTag);
    });
    <span style="color:#777">// Cut the content from the input textarea and send it</span>
    button.addEventListener(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">click</span><span style="color:#710">'</span></span>, <span style="color:#080;font-weight:bold">function</span> () {
        sendMessage();
    });
    <span style="color:#777">// Register pressing of the "enter" key while in textarea to send a message.</span>
    <span style="color:#777">// If user presses shift while entering, then add a newline instead.</span>
    messageInput.onkeydown = (<span style="color:#080;font-weight:bold">function</span>(e) {
        <span style="color:#080;font-weight:bold">if</span>(e.keyCode == <span style="color:#00D">13</span> &amp;&amp; !e.shiftKey) {
            e.preventDefault();
            sendMessage();
        }
    });
}

<span style="color:#777">// Creates the HTML tag and its children for a given message.</span>
<span style="color:#080;font-weight:bold">function</span> <span style="color:#06B;font-weight:bold">createMsgTag</span>(from, msgBody) {
    <span style="color:#080;font-weight:bold">var</span> msgTag = document.createElement(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">p</span><span style="color:#710">'</span></span>);
    msgTag.className = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">message</span><span style="color:#710">'</span></span>;
    <span style="color:#777">// Create the "from" section</span>
    <span style="color:#080;font-weight:bold">var</span> fromTag = document.createElement(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">span</span><span style="color:#710">'</span></span>);
    fromTag.className = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">message-from</span><span style="color:#710">'</span></span>;
    fromTag.appendChild(document.createTextNode(from + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">:</span><span style="color:#710">'</span></span>));
    <span style="color:#777">// Create the message body</span>
    <span style="color:#080;font-weight:bold">var</span> msgBodyTag = document.createElement(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">span</span><span style="color:#710">'</span></span>);
    msgBodyTag.className = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">message-body</span><span style="color:#710">'</span></span>;
    msgBodyTag.appendChild(document.createTextNode(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20"> </span><span style="color:#710">'</span></span> + msgBody));
    <span style="color:#777">// Put everything in the message tag</span>
    msgTag.appendChild(fromTag);
    msgTag.appendChild(msgBodyTag);
    <span style="color:#080;font-weight:bold">return</span> msgTag;
}

<span style="color:#080;font-weight:bold">var</span> aliceUA = createUA(aliceURI, aliceName);
setUpMessageInterface(aliceUA, bobURI,
                      <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">alice-message-display</span><span style="color:#710">'</span></span>,
                      <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">alice-message-input</span><span style="color:#710">'</span></span>,
                      <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">alice-message-button</span><span style="color:#710">'</span></span>);
</pre></div>
</div>
        </div>
      </div>
</div>
<div class="code-wrapper mobile-hide">
<div class="index-demo-code" id="code-data-channel">
        <div>
<div class="CodeRay">
  <div class="code"><pre><span style="color:#080;font-weight:bold">var</span> domain = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">sipjs.onsip.com</span><span style="color:#710">'</span></span>;
<span style="color:#080;font-weight:bold">var</span> aliceURI      = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">alice</span><span style="color:#710">'</span></span> + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">@</span><span style="color:#710">'</span></span> + domain;
<span style="color:#080;font-weight:bold">var</span> aliceName     = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Alice</span><span style="color:#710">'</span></span>;
<span style="color:#080;font-weight:bold">var</span> aliceButton   = document.getElementById(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">alice-video-button</span><span style="color:#710">'</span></span>);

<span style="color:#080;font-weight:bold">var</span> bobURI        = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">bob</span><span style="color:#710">'</span></span> + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">@</span><span style="color:#710">'</span></span> + domain;
<span style="color:#080;font-weight:bold">var</span> bobName       = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Bob</span><span style="color:#710">'</span></span>;
<span style="color:#080;font-weight:bold">var</span> bobButton     = document.getElementById(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">bob-video-button</span><span style="color:#710">'</span></span>);

<span style="color:#777">// Creates a user agent with the given parameters. This user agent is only for</span>
<span style="color:#777">// sending data, so it has a special media handler factory for the</span>
<span style="color:#777">// RTCDataChannel.</span>
<span style="color:#080;font-weight:bold">function</span> <span style="color:#06B;font-weight:bold">createDataUA</span>(callerURI, displayName) {
    <span style="color:#080;font-weight:bold">var</span> dataURI = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">data.</span><span style="color:#710">'</span></span> + callerURI;
    <span style="color:#080;font-weight:bold">var</span> configuration = {
        <span style="color:#606">traceSip</span>: <span style="color:#069">true</span>,
        <span style="color:#606">uri</span>: dataURI,
        <span style="color:#606">displayName</span>: displayName,
        <span style="color:#06B;font-weight:bold">mediaHandlerFactory</span>: <span style="color:#080;font-weight:bold">function</span> <span style="color:#06B;font-weight:bold">mediaHandlerFactory</span>(session, options) {

            <span style="color:#777">/* Like a default mediaHandler, but no streams to manage */</span>
            <span style="color:#080;font-weight:bold">var</span> self = <span style="color:#080;font-weight:bold">new</span> SIP.WebRTC.MediaHandler(session, {
                <span style="color:#606">mediaStreamManager</span>: {
                    <span style="color:#06B;font-weight:bold">acquire</span>: <span style="color:#080;font-weight:bold">function</span> (onSuccess) {
                        <span style="color:#777">// Must be async for on('dataChannel') callback to have a chance</span>
                        setTimeout(onSuccess.bind(<span style="color:#069">null</span>, {}), <span style="color:#00D">0</span>);
                    },
                    <span style="color:#06B;font-weight:bold">release</span>: <span style="color:#080;font-weight:bold">function</span> (onSuccess) {
                        setTimeout(onSuccess, <span style="color:#00D">0</span>);
                    }
                }
            });

            <span style="color:#777">// No stream to add. Assume success.</span>
            self.<span style="color:#06B;font-weight:bold">addStream</span> = <span style="color:#080;font-weight:bold">function</span> <span style="color:#06B;font-weight:bold">addStream</span>(stream, success, failure) {
                success();
            };

            <span style="color:#080;font-weight:bold">return</span> self;
        }
    };

    <span style="color:#080;font-weight:bold">return</span> dataUA = <span style="color:#080;font-weight:bold">new</span> SIP.UA(configuration);
}

<span style="color:#777">// Sets up the file transfer interface for the WebRTC data channel.</span>
<span style="color:#080;font-weight:bold">function</span> <span style="color:#06B;font-weight:bold">setUpDataInterface</span>(userAgent, target,
                            dataRenderId,
                            fileInputId,
                            filenameDisplayId,
                            dataShareButtonId,
                            errorMsgContainerId) {
    <span style="color:#777">// Target has a 'data.' prefix</span>
    <span style="color:#080;font-weight:bold">var</span> dataTarget = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">data.</span><span style="color:#710">'</span></span> + target;
    <span style="color:#080;font-weight:bold">var</span> dataRender = document.getElementById(dataRenderId);
    <span style="color:#080;font-weight:bold">var</span> fileInput = document.getElementById(fileInputId);
    <span style="color:#080;font-weight:bold">var</span> filenameDisplay = document.getElementById(filenameDisplayId);
    <span style="color:#080;font-weight:bold">var</span> dataShareButton = document.getElementById(dataShareButtonId);
    <span style="color:#080;font-weight:bold">var</span> errorMsgContainer = document.getElementById(errorMsgContainerId);
    <span style="color:#080;font-weight:bold">if</span> (errorMsgContainer.childNodes.length === <span style="color:#00D">0</span>) {
        errorMsgContainer.appendChild(document.createTextNode(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#710">'</span></span>));
    }

    <span style="color:#777">// The open data transfer session</span>
    <span style="color:#080;font-weight:bold">var</span> session;
    <span style="color:#777">// The File object for the chosen local file</span>
    <span style="color:#080;font-weight:bold">var</span> file = <span style="color:#069">null</span>;
    <span style="color:#777">// An ArrayBuffer of the loaded local File that has actually been loaded</span>
    <span style="color:#777">// into memory</span>
    <span style="color:#080;font-weight:bold">var</span> loadedFile = <span style="color:#069">null</span>;
    <span style="color:#777">// Metadata for the received file. The metadata has "name" and "type"</span>
    <span style="color:#080;font-weight:bold">var</span> receivedFileMetadata;
    <span style="color:#777">// The actual received file data</span>
    <span style="color:#080;font-weight:bold">var</span> receivedFileData;
    <span style="color:#777">// We do not support file chunking, so we can only send small files.</span>
    <span style="color:#080;font-weight:bold">var</span> maxChunkSize = <span style="color:#00D">16000</span>; <span style="color:#777">// 16 KB</span>
    <span style="color:#777">// The Blob object that combines the received file data and file type.</span>
    <span style="color:#777">// We cannot construct File objects, so we must make a Blob, which does not</span>
    <span style="color:#777">// have a file name.</span>
    <span style="color:#080;font-weight:bold">var</span> receivedFile;

    <span style="color:#777">// We have placeholder text in the message render box. It should be deleted</span>
    <span style="color:#777">// after we have sent or received our first message. This keeps track of</span>
    <span style="color:#777">// that.</span>
    <span style="color:#080;font-weight:bold">var</span> noMessages = <span style="color:#069">true</span>;

    <span style="color:#777">// When we receive an invite, we must set up our media handler to read in</span>
    <span style="color:#777">// data from over the RTCDataChannel.</span>
    <span style="color:#777">// Each data transmission consists of three parts:</span>
    <span style="color:#777">//   1) a JSON text object with the fields:</span>
    <span style="color:#777">//          "name" --&gt; file name</span>
    <span style="color:#777">//          "type" --&gt; file type</span>
    <span style="color:#777">//   2) an ArrayBuffer of binary content, which is the actual file.</span>
    <span style="color:#777">//   3) a terminating single newline character</span>
    <span style="color:#777">// The only order restriction on the transmission is that parts 1 and 2 come</span>
    <span style="color:#777">// before the terminating part 3.</span>
    <span style="color:#777">//</span>
    <span style="color:#777">// This then makes a link to the file and puts the file received notice and</span>
    <span style="color:#777">// link into the message display box.</span>
    <span style="color:#777">// After a terminating newline, the session is closed. So, each session has</span>
    <span style="color:#777">// only one file transfer.</span>
    userAgent.on(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">invite</span><span style="color:#710">'</span></span>, <span style="color:#080;font-weight:bold">function</span> (session) {
        session.mediaHandler.on(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">dataChannel</span><span style="color:#710">'</span></span>, <span style="color:#080;font-weight:bold">function</span> (dataChannel) {
            dataChannel.<span style="color:#06B;font-weight:bold">onmessage</span> = <span style="color:#080;font-weight:bold">function</span> (event) {
                <span style="color:#777">// The terminating empty newline.</span>
                <span style="color:#777">// Here we construct our Blob object and create a download URL</span>
                <span style="color:#777">// and plug it into the message render box.</span>
                <span style="color:#080;font-weight:bold">if</span> (<span style="color:#080;font-weight:bold">typeof</span>(event.data) === <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">string</span><span style="color:#710">'</span></span> &amp;&amp; event.data === <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">\n</span><span style="color:#710">'</span></span>) {
                    receivedFile = <span style="color:#080;font-weight:bold">new</span> Blob([receivedFileData],
                                            {<span style="color:#606">type</span>: receivedFileMetadata.type});
                    <span style="color:#080;font-weight:bold">var</span> fileUrl = URL.createObjectURL(receivedFile);
                    <span style="color:#080;font-weight:bold">var</span> msgTag = createDataMsgTag(
                        session.remoteIdentity.displayName,
                        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">data received</span><span style="color:#710">'</span></span>,
                        receivedFileMetadata.name,
                        fileUrl
                    );
                    <span style="color:#080;font-weight:bold">if</span> (noMessages) {
                        dataRender.removeChild(dataRender.children[<span style="color:#00D">0</span>]);
                        noMessages = <span style="color:#069">false</span>;
                    }
                    dataRender.appendChild(msgTag);
                    session.bye();
                <span style="color:#777">// The file metadata</span>
                } <span style="color:#080;font-weight:bold">else</span> <span style="color:#080;font-weight:bold">if</span> (<span style="color:#080;font-weight:bold">typeof</span>(event.data) === <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">string</span><span style="color:#710">'</span></span>) {
                    receivedFileMetadata = JSON.parse(event.data);
                <span style="color:#777">// The actual file content</span>
                } <span style="color:#080;font-weight:bold">else</span> {
                    receivedFileData = event.data;
                }
            };
        });
        session.accept();
    });

    <span style="color:#777">// This fires every time we choose a new file.</span>
    <span style="color:#777">// We display what file we have selected and load it into an ArrayBuffer.</span>
    fileInput.addEventListener(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">change</span><span style="color:#710">'</span></span>, <span style="color:#080;font-weight:bold">function</span> (event) {
        <span style="color:#080;font-weight:bold">var</span> tmpFile = event.target.files[<span style="color:#00D">0</span>];
        <span style="color:#080;font-weight:bold">if</span> (tmpFile !== <span style="color:#069">undefined</span> &amp;&amp; tmpFile !== file) {
            <span style="color:#777">// Reset the loadedFile variable, since we are supposed to load in a</span>
            <span style="color:#777">// new file but have not done so yet.</span>
            <span style="color:#777">// This value might not be set if the file is too large. This is</span>
            <span style="color:#777">// intended. We later prevent ourselves from sending a null file.</span>
            loadedFile = <span style="color:#069">null</span>;
            file = tmpFile;

            <span style="color:#080;font-weight:bold">var</span> filename = file.name;
            filenameDisplay.childNodes[<span style="color:#00D">0</span>].nodeValue = filename;

            <span style="color:#777">// File is small enough to send, so we load it.</span>
            <span style="color:#080;font-weight:bold">if</span> (file.size &lt;= maxChunkSize) {
                <span style="color:#777">// Clear the error message</span>
                errorMsgContainer.childNodes[<span style="color:#00D">0</span>].nodeValue = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#710">'</span></span>;
                <span style="color:#777">// errorMsgContainer.nodeValue = '';</span>
                <span style="color:#080;font-weight:bold">var</span> reader = <span style="color:#080;font-weight:bold">new</span> FileReader();
                reader.onload = (<span style="color:#080;font-weight:bold">function</span> (e) {
                    loadedFile = e.target.result;
                });
                reader.readAsArrayBuffer(file);
            }
            <span style="color:#777">// The file is too large to send. We still display its name, but we</span>
            <span style="color:#777">// do not set the loadedFile variable, which will prevent us from</span>
            <span style="color:#777">// sending it.</span>
            <span style="color:#080;font-weight:bold">else</span> {
                <span style="color:#777">// DBM: foobar</span>
                <span style="color:#080;font-weight:bold">var</span> errorStr = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">File too large to send using demo (chunking not supported)</span><span style="color:#710">'</span></span>;
                errorMsgContainer.childNodes[<span style="color:#00D">0</span>].nodeValue = errorStr;
                <span style="color:#777">// errorMsgContainer.nodeValue = errorStr;</span>
            }
        }
    });

    <span style="color:#777">// This shares the loaded file.</span>
    <span style="color:#777">// We invite the target and then send the data to them and wait for a "BYE"</span>
    <span style="color:#777">// response to signal that they got the file.</span>
    dataShareButton.addEventListener(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">click</span><span style="color:#710">'</span></span>, <span style="color:#080;font-weight:bold">function</span> () {
        <span style="color:#777">// No video or audio, only data</span>
        <span style="color:#080;font-weight:bold">var</span> options = {
            <span style="color:#606">media</span>: {
                <span style="color:#606">constraints</span>: {
                    <span style="color:#606">audio</span>: <span style="color:#069">false</span>,
                    <span style="color:#606">video</span>: <span style="color:#069">false</span>
                },
                <span style="color:#606">dataChannel</span>: <span style="color:#069">true</span>
            }
        };
        <span style="color:#777">// Make sure we don't try to send nothing</span>
        <span style="color:#080;font-weight:bold">if</span> (loadedFile !== <span style="color:#069">null</span>) {
            session = userAgent.invite(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">sip:</span><span style="color:#710">'</span></span> + dataTarget, options);

            session.mediaHandler.on(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">dataChannel</span><span style="color:#710">'</span></span>, <span style="color:#080;font-weight:bold">function</span> (dataChannel) {
                dataChannel.onopen = (<span style="color:#080;font-weight:bold">function</span> () {
                    <span style="color:#777">// Send JSON data about file</span>
                    dataChannel.send(JSON.stringify({
                        <span style="color:#606">name</span>: file.name,
                        <span style="color:#606">type</span>: file.type
                    }));
                    dataChannel.send(loadedFile);
                    <span style="color:#777">// Send empty newline to end transmission</span>
                    dataChannel.send(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">\n</span><span style="color:#710">'</span></span>);
                });
            });

            <span style="color:#777">// Handling the BYE response, which means that we successfully</span>
            <span style="color:#777">// sent the file.</span>
            session.on(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">bye</span><span style="color:#710">'</span></span>, <span style="color:#080;font-weight:bold">function</span> (req) {
                <span style="color:#080;font-weight:bold">var</span> msgTag = createDataMsgTag(
                    userAgent.configuration.displayName,
                    <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">data sent</span><span style="color:#710">'</span></span>,
                    file.name,
                    URL.createObjectURL(file)
                );
                <span style="color:#080;font-weight:bold">if</span> (noMessages) {
                    dataRender.removeChild(dataRender.children[<span style="color:#00D">0</span>]);
                    noMessages = <span style="color:#069">false</span>;
                }
                dataRender.appendChild(msgTag);
            });
        }
    });
}


<span style="color:#777">// Creates the HTML tag and its children for a given message.</span>
<span style="color:#080;font-weight:bold">function</span> <span style="color:#06B;font-weight:bold">createMsgTag</span>(from, msgBody) {
    <span style="color:#080;font-weight:bold">var</span> msgTag = document.createElement(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">p</span><span style="color:#710">'</span></span>);
    msgTag.className = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">message</span><span style="color:#710">'</span></span>;
    <span style="color:#777">// Create the "from" section</span>
    <span style="color:#080;font-weight:bold">var</span> fromTag = document.createElement(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">span</span><span style="color:#710">'</span></span>);
    fromTag.className = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">message-from</span><span style="color:#710">'</span></span>;
    fromTag.appendChild(document.createTextNode(from + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">:</span><span style="color:#710">'</span></span>));
    <span style="color:#777">// Create the message body</span>
    <span style="color:#080;font-weight:bold">var</span> msgBodyTag = document.createElement(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">span</span><span style="color:#710">'</span></span>);
    msgBodyTag.className = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">message-body</span><span style="color:#710">'</span></span>;
    msgBodyTag.appendChild(document.createTextNode(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20"> </span><span style="color:#710">'</span></span> + msgBody));
    <span style="color:#777">// Put everything in the message tag</span>
    msgTag.appendChild(fromTag);
    msgTag.appendChild(msgBodyTag);
    <span style="color:#080;font-weight:bold">return</span> msgTag;
}

<span style="color:#777">// Similar to the createMsgTag, but we add in an extra section with a link to</span>
<span style="color:#777">// the file sent or received.</span>
<span style="color:#777">// To download files, they must be anchors to the file reference.</span>
<span style="color:#777">// Typically, you will create your dataURI by calling URL.createObjectURL,</span>
<span style="color:#777">// which creates a unique URI (for some reason it's still called a URL).</span>
<span style="color:#080;font-weight:bold">function</span> <span style="color:#06B;font-weight:bold">createDataMsgTag</span>(from, msgBody, filename, dataURI) {
    <span style="color:#080;font-weight:bold">var</span> msgTag = createMsgTag(from, msgBody + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20"> </span><span style="color:#710">'</span></span>);
    <span style="color:#080;font-weight:bold">var</span> fileLinkTag = document.createElement(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">a</span><span style="color:#710">'</span></span>);
    fileLinkTag.className = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">message-link</span><span style="color:#710">'</span></span>;
    fileLinkTag.setAttribute(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">href</span><span style="color:#710">'</span></span>, dataURI);
    <span style="color:#777">// Set the filename of the Blob and indicate that it should download when we</span>
    <span style="color:#777">// click on it, not open up somewhere else.</span>
    fileLinkTag.setAttribute(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">download</span><span style="color:#710">'</span></span>, filename);
    fileLinkTag.appendChild(document.createTextNode(filename));
    msgTag.appendChild(fileLinkTag);
    <span style="color:#080;font-weight:bold">return</span> msgTag;
}

<span style="color:#080;font-weight:bold">var</span> aliceDataUA = createDataUA(aliceURI, aliceName);
setUpDataInterface(aliceDataUA, bobURI,
                   <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">alice-data-display</span><span style="color:#710">'</span></span>,
                   <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">alice-file-choose-input</span><span style="color:#710">'</span></span>,
                   <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">alice-filename</span><span style="color:#710">'</span></span>,
                   <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">alice-data-share-button</span><span style="color:#710">'</span></span>,
                   <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">alice-file-error-msg</span><span style="color:#710">'</span></span>);
</pre></div>
</div>
        </div>
      </div>
</div>
<div class="code-wrapper desktop-hide">
<div class="index-demo-code">
        <div>
<div class="CodeRay">
  <div class="code"><pre><span style="color:#080;font-weight:bold">var</span> ua = <span style="color:#080;font-weight:bold">new</span> SIP.UA();
ua.message(
  <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">will@example.onsip.com</span><span style="color:#710">'</span></span>,
  <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Hello, world!</span><span style="color:#710">'</span></span>
);

<span style="color:#080;font-weight:bold">var</span> session = ua.invite(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">will@example.onsip.com</span><span style="color:#710">'</span></span>);
session.on(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">accepted</span><span style="color:#710">'</span></span>, <span style="color:#080;font-weight:bold">function</span> () {
  <span style="color:#950">this</span>.bye();
});
</pre></div>
</div>
        </div>
      </div>
</div>

  <a class="mobile-hide button" href="/guides/full-demo-app/">
    <span class="text-hover-left">See Full Demo Code</span> <span class="hover-arrow">⟩</span>
  </a>
  <a class="desktop-hide button" href="/api/0.6.0/">
    <span class="text-hover-left">Check out the full API</span> <span class="hover-arrow">⟩</span>
  </a>
    <div class="clearfix"></div>
  </div>

  <div class="full-width-divider">
    <h2 class="orange-fg">Don't Want to Bother with the Back End?</h2>
    <p class="multicolumn">
      If you’d like to identify and locate your user addresses on the Internet so they can participate in RTC sessions, you’ll need SIP servers. You can build your own using open source <a href="http://www.freeswitch.org/">FreeSWITCH</a> or <a href="http://www.asterisk.org/">Asterisk</a>, or you can try out OnSIP Network - no system setup, modifications, maintenance, or upfront capital required.
      <a id="signup-button" class="mobile-hide button orange-bg left" href="https://signup.onsip.com/network">
        <span class="text-hover-left">Sign up for a free OnSIP sandbox account</span> <span class="hover-arrow">⟩</span>
      </a>
    </p>
    <div class="clearfix"></div>
    <a class="desktop-hide button orange-bg" href="https://signup.onsip.com/network">
        <span class="text-hover-left">Sign up for a free OnSIP sandbox account</span> <span class="hover-arrow">⟩</span>
    </a>
  </div>

  <div class="full-width-divider light-gray-bg">
    <div class="two-column-boxes highlights align-center">
      <div class="column-box">
        <div class="highlight-icon-wrapper">
          <div class="highlight-icon icon-books" onclick="window.location='/guides/'">
            <div class="hoverstate">
              <a href="/guides/">Guides</a>
            </div>
          </div>
        </div>
        <h3><span>Learn</span></h3>
        <p>New to SIP.js? Our guides and docs will have you up and running in a snap.</p>
      </div>
      <div class="column-box">
        <div class="highlight-icon-wrapper">
          <div class="highlight-icon icon-people" onclick="window.location='https://groups.google.com/forum/#!forum/sip_js'">
            <div class="hoverstate">
              <a href="https://groups.google.com/forum/#!forum/sip_js">Support</a>
            </div>
          </div>
        </div>
        <h3><span>Connect</span></h3>
        <p>Get answers, stay up to date, and become part of the SIP.js community.</p>
      </div>
      <div class="clearfix"></div>
    </div>
  </div>

  <div class="full-width-divider dark-gray-bg">
    <div class="two-column-boxes align-center">
      <div class="column-box">
        <h3>Built An App Using SIP.js?</h3>
      </div>
      <div class="column-box mobile-hide no-js-hide" id="success-column-box">
        <button id="success-opener" class="orange-bg">We want to hear about it!</button>
      </div>
      <div class="column-box desktop-hide no-js-block" id="success-column-newpage">
        <a id="success-newpage" class="button orange-bg" href="/success-story/">We want to hear about it!</a>
      </div>
      <div class="clearfix"></div>
    </div>
  </div>

  <div class="full-width-divider">
    <h2>Features</h2>

    <ul class="multicolumn">
<li>Register <a href="/faq/#what-is-sip">SIP</a> User Agents using the <a href="http://tools.ietf.org/html/rfc7118">SIP over WebSocket</a> transport</li>
      <li>Create Audio and Video sessions</li>
      <li>Send <a href="/guides/send-message/">Instant Messages</a> and view Presence</li>
      <li>Share your screen or desktop from Chrome</li>
      <li>Utilize advanced call features such as early media, call hold and resume, and transfers</li>
      <li>Send DTMF with SIP INFO</li>
      <li>100% open source, 100% JavaScript</li>
      <li>Chrome, Firefox, and Opera supported</li>
    </ul>
</div>
  <div class="full-width-divider light-gray-bg">
    <div class="two-column-boxes align-center" id="git-mit-images">
      <div class="column-box">
        <img src="/shared/img/github.png" alt="github: social coding">
</div>
      <div class="column-box">
        <img src="/shared/img/mit-license.png" alt="MIT open-source license">
</div>
      <div class="clearfix"></div>
    </div>
  </div>
  <div class="full-width-divider">
    <h2>SIP Standards</h2>
    <h4 class="intro">
<strong>SIP.js</strong> implements the following standard RFCs:</h4>

    <ul class="multicolumn">
<li><a href="http://tools.ietf.org/html/rfc3261">[3261] SIP: Session Initiation Protocol</a></li>
      <li><a href="http://tools.ietf.org/html/rfc3262">[3262] Reliability of Provisional Responses in SIP</a></li>
      <li><a href="http://tools.ietf.org/html/rfc3326">[3326] The Reason Header Field for SIP</a></li>
      <li><a href="http://tools.ietf.org/html/rfc3327">[3327] SIP Extension Header Field for Registering Non-Adjacent Contacts (Path)</a></li>
      <li><a href="http://tools.ietf.org/html/rfc3428">[3428] SIP Extension for Instant Messaging</a></li>
      <li><a href="http://tools.ietf.org/html/rfc3856">[3856] A Presence Event Package for SIP</a></li>
      <li><a href="http://tools.ietf.org/html/rfc4235">[4235] An INVITE-Initiated Dialog Event Package for SIP</a></li>
      <li><a href="http://tools.ietf.org/html/rfc3515">[3515] SIP Refer Method</a></li>
      <li><a href="http://tools.ietf.org/html/rfc5626">[5626] Managing Client-Initiated Connections in SIP (SIP Outbound)</a></li>
      <li><a href="http://tools.ietf.org/html/rfc5954">[5954] Essential Correction for IPv6 ABNF and URI Comparison in RFC 3261</a></li>
      <li><a href="http://tools.ietf.org/html/rfc6026">[6026] Correct Transaction Handling for 2xx Responses to SIP INVITE Requests</a></li>
      <li><a href="http://tools.ietf.org/html/rfc6665">[6665] SIP-Specific Event Notification (SUBSCRIBE/NOTIFY, formerly RFC 3265)</a></li>
      <li><a href="http://tools.ietf.org/html/rfc7118">[7118] The WebSocket Protocol as a Transport for SIP</a></li>
    </ul>
</div>
</div>
    </div>

	<footer class="light-gray-bg">
  <div class="wrapper">
    <div id="onsip-stamp">
      <span id="made-by-prefix">made by</span>
      <a href="https://www.onsip.com/webrtc-sip-network" id="onsip"></a>
    </div>
    <nav class="left">
      <ul class="horizontal">
        <li><a href="https://groups.google.com/forum/#!forum/sip_js" target="_blank">Mailing List</a></li>
        <li><a href="https://github.com/onsip/sip.js/issues" target="_blank">Report Issues</a></li>
        <li><a href="/license/">License</a></li>
      </ul>
    </nav>
    <nav class="right">
      <ul class="horizontal">
        <li><a href="http://onsip.com/blog" target="_blank">Blog</a></li>
        <li><a href="/aboutus/">About</a></li>
        <li><a href="/faq/">FAQ</a></li>
      </ul>
    </nav>
    <div class="clearfix"></div>
  </div>
</footer>


    <!-- This is the actual popup -->
<div class="popup-container mobile-hide">
  <div id="success-story" class="popup">
    <div class="close-popup">x</div>
    <h2 class="orange-fg">Tell us about your app</h2>
    <h4>We'd like to share your story on our blog</h4>

    <form name="success_story" id="success-story-form"
          action="https://www.salesforce.com/servlet/servlet.WebToLead?encoding=UTF-8"
          target="post-receiver" method="POST">
      <!-- These must be no whitespace between inputs, because otherwise we have
           a space in between the two inline elements and then these won't align
           correctly with elements wrapped around the floated textarea. -->
      <input type="text" id="full_name" name="full_name"
             placeholder="full name"
             maxlength="120" required="required"
    /><input type="email" id="email" name="email"
             placeholder="company email address"
             maxlength="255" required="required" />
      <textarea id="success-app-desc" name="description" rows="10" cols="30"
                required="required"
                placeholder="describe your app"></textarea>
      <input type="tel" name="phone" placeholder="phone number (optional)"
             maxlength="15" />
      <button id="success-submit" type="submit">share</button>
      <input type="hidden" id="first_name" name="first_name"/>
      <input type="hidden" id="last_name" name="last_name"/>
      <input type="hidden" name="lead_source" value="sipjscom"/>
      <input type="hidden" name="Lead_Type__c" value="Customer Info"/>
      <input type="hidden" name="encoding" value="UTF-8"/>
      <input type="hidden" name="oid" value="00D3000000011or"/>
      <input type="hidden" name="retURL" value="http://sipjs.com/thank-you/"/>
      <div class="clearfix"></div>
    </form>
  </div>
</div>

<!-- This is the actual popup -->
<div class="popup-container mobile-hide">
  <div id="thank-you-popup" class="popup">
    <div class="close-popup">x</div>
    <div class="feature">
      <h1 id="thank-you-heading">Thanks for telling us about your app!</h1>
      <p>
        We love hearing what people are doing with SIP.js, so thanks for dropping
        us a line. If you have any questions, check out our Support page, and keep
        an eye out on our blog for any new developments with SIP.js and real-time
        communications.</p>
    </div>
  </div>
</div>

<!-- This iframe is so we can POST the results of the above form submission to
     a server that can handle it. The frame is hidden. -->
<iframe name="post-receiver" id="post-receiver" src="">
</iframe>

<!-- This is a overlay dimmer that goes in the background when the popup
     appears -->
<div class="overlay">
</div>

<script src="/shared/js/success_story.js" type="text/javascript"></script>

    <script src="/shared/js/retina.js" type="text/javascript"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1008379-16', 'sipjs.com');
  ga('send', 'pageview');
</script>
<script>
  // Remove all 'no-js-hide' classes because Javascript is working
  $(function () {
      $('.no-js-hide').each(function (i, e) {
          $(e).removeClass('no-js-hide');
      });
      $('.no-js-block').each(function (i, e) {
          $(e).removeClass('no-js-block');
      });
  });
</script>

    <script src="/homepage/mobile_nav.js" type="text/javascript"></script>
    <script src="/download/sip-0.6.2.js" type="text/javascript"></script>
    <script src="/homepage/feature_selector.js" type="text/javascript"></script>
    <script src="/homepage/file_input_hack.js" type="text/javascript"></script>
    <script src="/homepage/sipjs_demos.js" type="text/javascript"></script>
</body>
</html>
