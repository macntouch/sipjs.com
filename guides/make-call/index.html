<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Language" content="en-us" />
  <meta http-equiv="imagetoolbar" content="false" />
  <meta name="MSSmartTagsPreventParsing" content="true" />
  <meta name="description" content="How to enable your WebRTC application to make voice and video calls and render the video via HTML5 video elements." />
  <title>Make a call | SIP.js</title>
  <link rel="alternate" type="application/atom+xml" title="API Changes" href="/changes.atom" />
  <link href='http://fonts.googleapis.com/css?family=Nunito:400,700,300|Varela+Round' rel='stylesheet' type='text/css'>
  <link href="/css/reset.css" rel="stylesheet" type="text/css" />
  <link href="/css/960.css" rel="stylesheet" type="text/css" />
  <link href="/css/uv_active4d.css" rel="stylesheet" type="text/css" />
  <link href="/shared/css/documentation.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/shared/css/pygments.css" media="screen" rel="stylesheet" type="text/css" />
  <script src="/shared/js/jquery.js" type="text/javascript"></script>
  <script src="/shared/js/documentation.js" type="text/javascript"></script>
  
  <link rel="shortcut icon" type="image/x-icon" href="/shared/img/favicon-6.ico"/>
</head>


<body class="guides">
  <header id="siteHeader">
  <div class="wrapper">
    <a href="/"><img id="logo" src="/shared/img/logo.png" alt="sip.js"></a>
    <nav id="mainNav">
      <ul class="horizontal">
        <li><a href="/download/">Download</a></li>
        <li><a href="/api/0.5.0/">API</a></li>
        <li><a href="/guides/">Guides</a></li>
        <li><a href="https://github.com/onsip/sip.js" target="_blank">Github</a></li>
        <li><a href="/aboutus/" class="nav-aboutus">About Us</a></li>
        <li><a href="https://groups.google.com/forum/#!forum/sip_js" target="_blank">Support</a></li>
      <ul>
    </nav>
  </div>
</header>


  <article id="main" class="wrapper group">
    <header id="sectionHeader">
      <h1><a href="/guides/">Guides</a></h1>
    </header>
    <div id="content">
      <h1 id="make-a-call">Make a Call</h1>


<p>Let’s walk through core API concepts as we tackle some everyday use cases.</p>

<h3 id="setup-and-video-elements">Setup and Video Elements</h3>

<p>First we must create the files index.html, main.js, and style.css in the same folder.  In the index.html file we need to include the <a href="/download/">SIP.js library</a>, as well as the main.js file.  </p>

<p>A <code>&lt;video&gt;</code> element is need to display the video stream.  The <code>&lt;video&gt;</code> element adds a standard way for browsers to display video over the internet without additional plugins. This makes <code>&lt;video&gt;</code> elements perfect for WebRTC. </p>

<p>Within the <code>&lt;body&gt;</code> tags, there is a <code>remoteVideo</code> <code>&lt;video&gt;</code> element, to display the video of the person being called.  There is also a <code>localVideo</code> <code>&lt;video&gt;</code> element, to display the video stream that is being sent to the person being called.  The local video stream should always be muted to prevent feedback.</p>

<p>In the style.css file we will put a border around the <code>&lt;video&gt;</code> elements, to visualize them better.</p>

<iframe style="width: 100%; height: 300px" src="http://jsfiddle.net/mgc2e/11/embedded/html,js,css,result/">
</iframe>

<h3 id="making-the-call">Making the Call</h3>

<p>These <code>&lt;video&gt;</code> elements are not useful if we aren’t calling anyone, so let’s make a call.</p>

<h4 id="creating-the-user-agent">Creating the User Agent</h4>

<p>In order to make calls and send messages, create a SIP user agent.  Calling <code>SIP.UA()</code> method, with no parameters, creates an anonymous user agent.</p>

<iframe style="width: 100%; height: 300px" src="http://jsfiddle.net/4m7dc/12/embedded/js,html,css,result/">
</iframe>

<h4 id="sending-the-invite">Sending the Invite</h4>

<p>After the user agent has connected to the SIP server, we can send an invite to make a call and thereby create a SIP session.</p>

<p>To send an invite first create a javascript object, which contains the <code>media</code> variable that specifies whether the session contains audio and video (i.e. whether it is a video call or an audio call).  </p>

<p>Then call the <code>.invite()</code> method with the target address and the <code>options</code> object containing media information.</p>

<p>After invite is called, the browser will ask for permission to access the camera and microphone.  Permission must be allowed to make the call.  The person being called has the choice of accepting or rejecting the call.  </p>

<p>An <code>endCall</code> button is added to terminate the session using the <code>.bye()</code> method.</p>

<iframe style="width: 100%; height: 410px" src="http://jsfiddle.net/T4Kv2/18/embedded/js,html,css,result/">
</iframe>

<h3 id="displaying-the-call">Displaying the Call</h3>

<p>Although we are now able to make calls, we are not yet displaying the videos on the screen.  To do this attach the video streams to the <code>&lt;video&gt;</code> elements.  </p>

<p>The streams cannot be attached until the call begins. Catch the <code>accepted</code> event and attach the video streams after this point.  </p>

<p>Create a new function called onAccepted(), and bind it to the <code>accepted</code> event.  Inside this function, call the <code>attachMediaStream</code> function on both media streams, and then play both video elements.</p>

<p>The function <code>attachMediaStream</code> attaches the media stream to the video element.</p>

<iframe style="width: 100%; height: 600px" src="http://jsfiddle.net/qWmG7/26/embedded/js,html,css,result/">
</iframe>
    </div>

    <nav id="sideNav">
  <ul>
    <li><a href="/guides/">Overview</a></li>
    <li><a href="/guides/convert-to-sipjs/">Convert to SIP.js</a></li>
    <li><a href="/guides/user-agent-construction/">User Agent Construction</a></li>
    <li><a href="/guides/make-call/">Make a Call</a></li>
    <li><a href="/guides/receive-call/">Receive a Call</a></li>
    <li><a href="/guides/send-dtmf/">Send Dtmf</a></li>
    <li><a href="/guides/send-message/">Send Message</a></li>
    <li><a class="last" href="/guides/reuse-mediastreams/">Reuse MediaStreams</a></li>
  </ul>
</nav>


  </article>

  <footer class="wrapper">
  <a href="https://www.onsip.com/webrtc-sip-network" id="onsip"></a>
  <nav class="left">
    <ul class="horizontal">
      <li><a href="https://groups.google.com/forum/#!forum/sip_js" target="_blank">Mailing List</a></li>        
      <li><a href="https://github.com/onsip/sip.js/issues" target="_blank">Report Issues</a></li>
      <li><a href="/license/">License</a></li>
    </ul>
  </nav>
  <nav class="right">
    <ul class="horizontal">
      <li><a href="http://onsip.com/blog" target="_blank">Blog</a></li>
      <li><a href="/aboutus/">About</a></li>
      <li><a href="/faq/">FAQ</a></li>
    </ul>
  </nav>
  <div class="clearfix"></div>
</footer>
<script src="/shared/js/retina.js" type="text/javascript"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1008379-16', 'sipjs.com');
  ga('send', 'pageview');
</script>

</body>
</html>
